RaspPi SD Card Initialization

1. Download latest image of Raspian Wheezy
Used here: RASPBIAN - Debian Wheezy 
Release date: 2015-05-05
Default login:pi / raspberry
Kernel version:3.18
https://www.raspberrypi.org/downloads/
Verify SHA-1:cb799af077930ff7cbcfaa251b4c6e25b11483de
$ openssl sha1 2015-05-05-raspbian-wheezy.zip

2. Write the downloaded image to a card according to this guideline:
https://www.raspberrypi.org/documentation/installation/installing-images/README.md
	cd into the folder with the image
$ diskutil list
/dev/disk0
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:      GUID_partition_scheme                        *1.0 TB     disk0
   1:                        EFI EFI                     209.7 MB   disk0s1
   2:                  Apple_HFS Macintosh HD            698.0 GB   disk0s2
   3:                 Apple_Boot Recovery HD             650.0 MB   disk0s3
   4:       Microsoft Basic Data BOOTCAMP                301.7 GB   disk0s4
/dev/disk1
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:     FDisk_partition_scheme                        *31.4 GB    disk1
   1:             Windows_FAT_32 NO NAME                 31.4 GB    disk1s1

Identify the disk (not partition) of your SD card e.g. disk1 

$ diskutil unmountDisk /dev/disk1
Unmount of all volumes on disk1 was successful

$ sudo dd bs=1m if=2015-05-05-raspbian-wheezy.img of=/dev/disk1
(This takes several minutes.)
3125+0 records in
3125+0 records out
3276800000 bytes transferred in 950.170971 secs (3448643 bytes/sec)

3. Hook RPi to power and ethernet(access to internet).
Connect To RPi with a screen via hdmi and boot rpi up.

4. in ‘raspi-config’ shown on attached screen: 
Enable Camera (option 5.)
Advanced options (option 8.)
	A4 SSH (enable)
	A0 Update tool to the latest version
<Finish> raspi-config 

5. Upgrade/update kernel
	sudo apt-get update
	sudo apt-get upgrade

6. Set up partition table
	Expand mmcblk0p2 to reasonable size (4 GB) for system files:
	$ sudo fdisk /dev/mmcblk0
	command: p
	then command: d 2
	then: n p 2 122880 7935380
	then command: w
	$ sudo shutdown -r now
	
	Create and format new partition: mmcblk0p3
		This will store user files
		Mount as /home

7. Clone fishcode repo
	cd
	mkdir ros
	mkdir ros/src
	cd ros/src
	git clone https://rkk@login.csail.mit.edu:/afs/csail.mit.edu/group/drl/softrobotics/fishcode.git
	cd fishcode
	git checkout dev

8. Configure Edimax wifi dongle and replace fstab
	sudo apt-get install wpasupplicant
	cd ~/ros/src/fishcode/rpi_setup
	sudo cp wpa_supplicant.conf /etc/wpa_supplicant/wpa_supplicant.conf
	sudo cp 8192cu.conf /etc/modprobe.d/
	sudo cp fstab /etc/fstab

9. Reboot to remount system filesystems read-only
	sudo reboot
	If there are errors, try to fix

10. Install ROS Indigo -- big step
	[from instructions online at http://wiki.ros.org/ROSberryPi/Installing%20ROS%20Indigo%20on%20Raspberry%20Pi]

	# re-mount system partition as writeable for this install
	sudo mount /dev/mmcblk0p2 -o=remount,rw

	# setup ROS Repos
	sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu wheezy main" > /etc/apt/sources.list.d/ros-latest.list'
	wget https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -O - | sudo apt-key add -
	sudo apt-get update

	# install bootstrap dependencies
	sudo apt-get install python-setuptools python-pip python-yaml python-argparse python-distribute python-docutils python-dateutil python-setuptools python-six
	sudo pip install rosdep rosinstall_generator wstool rosinstall

	# initialize rosdep
	sudo rosdep init
	rosdep update

	# create catkin workspace
	mkdir ~/ros_catkin_ws
	cd ~/ros_catkin_ws

	# dl Ros source
	rosinstall_generator ros_comm --rosdistro indigo --deps --wet-only --exclude roslisp --tar > indigo-ros_comm-wet.rosinstall
	wstool init src indigo-ros_comm-wet.rosinstall

	# Resolve dependencies
	mkdir ~/ros_catkin_ws/external_src
	sudo apt-get install checkinstall cmake
	sudo sh -c 'echo "deb-src http://mirrordirector.raspbian.org/raspbian/ testing main contrib non-free rpi" >> /etc/apt/sources.list'
	sudo apt-get update

	# Install libconsole-bridge-dev
	cd ~/ros_catkin_ws/external_src
	sudo apt-get build-dep console-bridge
	apt-get source -b console-bridge
	sudo dpkg -i libconsole-bridge0.2_*.deb libconsole-bridge-dev_*.deb

	# Install liblz4-dev
	cd ~/ros_catkin_ws/external_src
	apt-get source -b lz4
	sudo dpkg -i liblz4-*.deb

	# Resolve remaining dependencies with rosdep
	cd ~/ros_catkin_ws
	rosdep install --from-paths src --ignore-src --rosdistro indigo -y -r --os=debian:wheezy

	# Build the workspace and install
	sudo ./src/catkin/bin/catkin_make_isolated --install -DCMAKE_BUILD_TYPE=Release --install-space /opt/ros/indigo

	# Add the following lines to ~/.bashrc
	source /opt/ros/indigo/setup.bash
	source ~/ros/devel/setup.bash

11. Install rpi camera library
	cd ~/ros/src/fishcode
	# Extract raspicam-0.1.3.zip to ~ directory
	unzip raspicam-0.1.3.zip -d ~

	# Follow setup directions within raspicam-0.1.3 folder to build and install libraspicam (without OpenCV plugin)

12. Install OpenCV
	sudo apt-get install ros-indigo-opencv3

13. Build fishcode
	cd ~/ros/src/
	catkin_init_workspace
	cd ..
	catkin_make